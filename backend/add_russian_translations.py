"""
러시아어 번역을 모든 게시글에 추가하는 스크립트
"""
import sys
import io

# UTF-8 출력 설정
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

from app.db.database import SessionLocal
from app.models.post import Post

# 한글 제목에 대한 러시아어 번역 매핑
translations = {
    # 공지사항
    "🎉 Russian.Town 커뮤니티 오픈!": "🎉 Открытие сообщества Russian.Town!",
    "📋 커뮤니티 이용 규칙 안내": "📋 Правила использования сообщества",
    "💡 자동 번역 기능 추가 안내": "💡 Уведомление о добавлении автоматического перевода",

    # 자유게시판
    "이태원에서 보르쉬 먹을 수 있는 곳 추천!": "Порекомендуйте места в Итхэвоне, где можно поесть борщ!",
    "주말에 축구하실 분 계신가요?": "Кто-нибудь хочет играть в футбол на выходных?",

    # 질문과 답변
    "외국인등록증 재발급 어떻게 하나요?": "Как переоформить карту иностранца?",
    "한국에서 러시아 운전면허증 사용 가능한가요?": "Можно ли использовать российские права в Корее?",
    "인천공항에서 서울 시내 가는 가장 저렴한 방법은?": "Как дешевле всего добраться из аэропорта Инчхон в центр Сеула?",

    # 벼룩시장
    "[판매] 삼성 냉장고 거의 새것 (15만원)": "[Продажа] Холодильник Samsung почти новый (150,000₩)",
    "[나눔] 러시아 소설책 50권 무료나눔": "[Отдам] 50 русских книг бесплатно",
    "판매 삼성 냉장고 거의 새것 15만원": "[Продажа] Холодильник Samsung почти новый 150,000₩",
    "구매 러시아어 책 구합니다": "[Покупка] Ищу русские книги",
    "나눔 아기 옷 무료로 드려요": "[Отдам] Детская одежда бесплатно",
    "교환 러시아 식품 한국 화장품": "[Обмен] Русские продукты ⇄ Корейская косметика",
    "판매 자이언트 MTB 자전거 8만원": "[Продажа] Велосипед Giant MTB 80,000₩",

    # 구인구직
    "[구인] IT 스타트업 러시아어 가능자 (월 400만원)": "[Вакансия] IT стартап, знание русского (4,000,000₩/мес)",
    "[구직] 한러 통번역 가능합니다 (경력 5년)": "[Ищу работу] Переводчик корейский-русский (опыт 5 лет)",
    "[구인] 무역회사 해외영업 담당자 모집": "[Вакансия] Торговая компания, менеджер по экспорту",
    "구인 IT 스타트업 러시아어 가능자 월 400만원": "[Вакансия] IT стартап, знание русского, 4,000,000₩/мес",
    "구직 한러 통번역 가능합니다 경력 5년": "[Ищу работу] Переводчик корейский-русский, опыт 5 лет",
    "구인 무역회사 해외영업 담당 모집": "[Вакансия] Торговая компания, менеджер по экспорту",
    "구직 요리사 러시아 음식 전문": "[Ищу работу] Повар, специалист по русской кухне",
    "구인 호텔 프론트 직원 모집 러시아어 필수": "[Вакансия] Отель, администратор, русский обязателен",
    "구직 개발자 백엔드 Python Django": "[Ищу работу] Backend разработчик Python/Django",

    # 행정정보
    "F2 비자 연장 성공 후기 소요기간 15일": "Отзыв об успешном продлении визы F2, срок 15 дней",
    "종합소득세 신고 방법 총정리": "Полная инструкция по подаче декларации о доходах",
    "운전면허 변경 절차 및 필요서류": "Процедура замены водительских прав и необходимые документы",

    # 생활정보
    "신한은행 vs 우리은행 외국인 계좌 비교": "Shinhan Bank vs Woori Bank: сравнение счетов для иностранцев",
    "한국 생활 필수 앱 TOP 10": "ТОП-10 необходимых приложений для жизни в Корее",
    "저렴한 마트 추천 이마트 롯데 코스트코": "Рекомендации дешевых супермаркетов: E-Mart, Lotte, Costco",

    # 창업정보
    "한국에서 외국인 사업자등록 완벽 가이드": "Полное руководство по регистрации бизнеса для иностранцев в Корее",
    "온라인 쇼핑몰 창업 후기 스마트스토어": "Отзыв об открытии интернет-магазина SmartStore",
}

def add_translations():
    db = SessionLocal()

    try:
        posts = db.query(Post).all()
        updated_count = 0

        for post in posts:
            title = post.title.strip()

            if title in translations:
                # 러시아어 번역 추가
                post.translated_title_ru = translations[title]
                post.translated_title_ko = title  # 한글은 그대로
                updated_count += 1
                print(f"✓ 번역 추가: {title[:50]}")
            else:
                print(f"✗ 매칭 안됨: {title[:50]}")

        db.commit()
        print(f"\n=== 완료 ===")
        print(f"총 {updated_count}개 게시글에 러시아어 번역 추가됨")

    except Exception as e:
        print(f"에러 발생: {e}")
        db.rollback()
    finally:
        db.close()

if __name__ == "__main__":
    add_translations()
